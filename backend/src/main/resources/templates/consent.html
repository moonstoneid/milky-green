<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:th="https://www.thymeleaf.org">
<head>
  <title>Consent</title>
</head>
<body>
  <h1>Consent required</h1>
  <p>
    The application
    <span id="oauthClientId" th:text="${clientId}"></span>
    wants to access your account
    <span th:text="${principalName}"></span>
    .
  </p>
  <p>The following permissions are requested by the above app.<br/>Please review these and consent
    if you approve.</p>
  <form method="post" action="/oauth2/authorize" id="consentForm">
    <input type="hidden" name="client_id" th:value="${clientId}">
    <input type="hidden" name="state" th:value="${state}">
    <input type="hidden" name="message" id="siweMessage">
    <input type="hidden" name="signature" id="siweSignature">

    <div th:each="scope: ${scopes}">
      <input type="checkbox"
             name="scope"
             th:value="${scope.scope}"
             th:id="${scope.scope}"
             checked>
      <label th:for="${scope.scope}" th:text="${scope.scope}"></label>
      <p th:text="${scope.description}"></p>
    </div>

    <p th:if="${not #lists.isEmpty(previouslyApprovedScopes)}">You have already granted the
      following permissions to the above app:</p>
    <div th:each="scope: ${previouslyApprovedScopes}">
      <input type="checkbox"
             th:id="${scope.scope}"
             disabled
             checked>
      <label th:for="${scope.scope}" th:text="${scope.scope}"></label>
      <p th:text="${scope.description}"></p>
    </div>

    <button type="submit" id="consentApproveButton" name="consent_action" value="approve">Submit Consent</button>
    <button type="submit" id="consentDenyButton" name="consent_action" value="cancel">Cancel</button>
  </form>
  <script type="text/javascript" th:src="@{../js/bundle.js}"></script>
</body>
</html>
