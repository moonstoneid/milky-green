<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:th="https://www.thymeleaf.org">
<head>
  <title>Consent</title>
  <link rel="stylesheet" th:href="@{/webjars/bootstrap/css/bootstrap.min.css}" />
  <link rel="stylesheet" th:href="@{/css/style.css}" />
</head>
<body class="text-center">
  <img class="mb-4" th:src="@{/img/ethereum.svg}" alt="Ethereum logo" width="72" height="72">
  <h4 class="h4 mb-3 font-weight-normal">Sign-In with Ethereum</h4>
  <h5 class="h5 mb-3 font-weight-normal">Consent required</h5>
  <p class="mt-0 mb-3 text">The application
    <span id="oauthClientId" th:text="${clientId}"></span>
    wants to access your account<br>
    <span th:text="${principalName}"></span>
    .
  </p>
  <p class="mt-0 mb-3 text">The following permissions are requested by the above app.<br/>Please review these and consent
    if you approve.</p>
  <form method="post" action="/oauth2/authorize" id="consentForm">
    <input type="hidden" name="client_id" th:value="${clientId}">
    <input type="hidden" name="state" th:value="${state}">
    <input type="hidden" name="message" id="siweMessage">
    <input type="hidden" name="signature" id="siweSignature">

    <div th:each="scope: ${scopes}">
      <input type="checkbox"
             name="scope"
             th:value="${scope.scope}"
             th:id="${scope.scope}"
             checked>
      <label th:for="${scope.scope}" th:text="${scope.scope}"></label>
      <p th:text="${scope.description}"></p>
    </div>

    <p th:if="${not #lists.isEmpty(previouslyApprovedScopes)}">You have already granted the
      following permissions to the above app:</p>
    <div th:each="scope: ${previouslyApprovedScopes}">
      <input type="checkbox"
             th:id="${scope.scope}"
             disabled
             checked>
      <label th:for="${scope.scope}" th:text="${scope.scope}"></label>
      <p th:text="${scope.description}"></p>
    </div>
    <button type="submit" class="btn btn btn-dark" id="consentApproveButton" name="consent_action" value="approve">Submit Consent</button>
    <button type="submit" class="btn btn-outline-danger" id="consentDenyButton" name="consent_action" value="cancel">Cancel</button>
  </form>
  <script type="text/javascript" th:src="@{../js/bundle.js}"></script>
  <script type="text/javascript" th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script>
</body>
</html>
